Stokes方程推导

四场问题表述
1.1原始控制方程 (不可压缩牛顿流体稳态流动):
- 平衡方程: ∇∙ σ + b = 0
- 本构方程: σ = 2με - p1
- 协调方程: ε = ∇^(^s)  u =  1/2(∇u + (∇u)^T)
- 不可压缩条件: ∇∙ u = 0

其中：
- u 为速度场
- ∇^(^s)  u =  1/2(∇u + (∇u)^T) (对称梯度算子)
- μ: 粘性系数，p: 压力（拉格朗日乘子)

1.2. 动量守恒方程推导
平衡方程
∇∙ σ + b = 0
来源: 牛顿第二定律（动量守恒）的稳态形式
推导:
原动量方程：ρ(Du/Dt) = ∇∙ σ + b
稳态时 (Du/Dt)=0，惯性项消失，简化为 ∇∙ σ + b = 0

1.3. 牛顿流体本构方程推导
本构方程:
σ = 2με - p1
来源: 牛顿流体假设（应力与应变率线性关系）。
推导:
应力分解为偏应力 σ' 和压力 -p1，即 σ=σ'-p1
牛顿流体假设：σ'=2με（μ为粘度，ε为应变率张量）。
合并得 σ=2με-p1

1.4. 应变率定义推导
协调方程: 
ε = ∇^(^s)  u =  1/2(∇u + (∇u)^T)
来源: 速度梯度分解为对称部分（应变率）和反对称部分（刚体转动）。
推导:
速度梯度 ∇u 分解为对称部分 ε 和反对称部分 ω：
∇u=ε+ω,ε=1/2 (∇u+(∇u)T)
仅对称部分 ε 贡献应力。

1.5. 不可压缩条件推导
不可压缩条件: 
∇∙ u = 0
来源: 质量守恒方程（连续方程）。
推导:
连续方程：Dt/Dρ+ρ ∇⋅u=0。
密度恒定ρ 为常数时 Dt/Dρ =0，故 ∇⋅u=0。

方程简化：四场 → 两场
消去 ε 和 σ 的关键步骤：
1. 代入本构方程到平衡方程：
   ∇∙(2μ ∇^(^s) u - p1) + b = 0
2. 展开散度运算：
   2μ ∇∙(∇^(^s)  u) - ∇p + b = 0
3. 利用对称梯度特性：
   μΔu - ∇p + b = 0

最终得到两场问题：
- μΔu - ∇p + b = 0
- ∇∙ u = 0

7. 定义能量泛函
简单推导
  Π(u) = μ  1/2  ∫Ω ∇u∶ ∇u dΩ - ∫Ω b·u dΩ

8. 变分原理推导
步骤 1：定义约束泛函
引入拉格朗日乘子 p 处理不可压缩条件：
L(u,p) = μ  1/2  ∫Ω ∇u∶ ∇u dΩ - ∫Ω b·u dΩ - ∫Ω p ∇∙ u dΩ

步骤 2：取一阶变分
对 u 和 p 分别取变分 δu 和 δp：
-
 dL[δu] = μ ∫Ω ∇δu∶ ∇u dΩ - ∫Ω δu·b dΩ - ∫Ω p ∇∙ δu dΩ = 0

dL[δp] = -∫Ω δp ∇∙ u dΩ = 0

9. 鞍点问题与离散化
弱形式可以写成以下鞍点问题：
- k(u,v) + k(p,v) = F(v)
- k(u,q) = 0

其中
- k(u,v) = ∫Ω 2μ∇^(^s)  u∶ ∇^(^s)  v dx
- k(p,v) = -∫Ω p ∇∙v dx
- F(v) = ∫Ω b·v dx

离散化后得到线性代数系统：
[█(〖k 〗^uu k^up@k^up  k^pp )]  [█(u@p)]= [█(f@0)]
10. 结论
- 从物理守恒定律出发，我们推导出不可压缩牛顿流体的四场形式：
  ∇∙ σ + b = 0
  σ = 2με - p1
  ε =∇^(^s)  u
  ∇∙ u = 0

- 消去应变率与应力场后，可得经典的 (u, p) 形式：
  ∇∙(2μ ∇^(^s)   u - p1) + b = 0
  ∇∙ u = 0

- 进一步通过能量泛函取变分得到弱形式，离散化后形成典型的鞍点矩阵系统，可用数值方法求解。

